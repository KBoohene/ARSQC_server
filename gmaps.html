<!doctype html>
<html>
  <head>
    <style>
      #map {
        width: 1000px;
        height: 500px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <!-- Google Maps JS API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDVy-fqmHDhDqCo3N9MQFknESI5mbzOepU"></script>
    <!-- GMaps Library -->
    <script src="gmaps.js"></script>
    <script src="calLatLng.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>

        /* Map Object */
        var mapObj = new GMaps({
          zoom:10,
          el: '#map',
          lat: 6.68848,
          lng: -1.62443
        });

      /* mapObj.addMarker({
          lat: 6.68848,
          lng:-1.62443
                    });*/


      $(document).ready(function(){

        var sourceLng, sourcelat;
        var destiLng, destiLat;
        $("#pos-link").click(function(event) {

            GMaps.geolocate({
              success: function(position) {
                mapObj.setCenter(position.coords.latitude, position.coords.longitude);
                sourceLng=position.coords.longitude;
                sourcelat=position.coords.latitude;
                //console.log(sourceLng);
               /* mapObj.addMarker({
                      lat: position.coords.latitude,
                      lng: position.coords.longitude
                    });*/
              },
              error: function(error) {
                alert('Geolocation failed: '+error.message);
              },
              not_supported: function() {
                alert("Your browser does not support geolocation");
              }
          });
        });

        $("#submit").click(function() {
            GMaps.geocode({
              address: $('#to').val(),
              callback: function(results, status) {
                if (status == 'OK') {
                  var latlng = results[0].geometry.location;
                   mapObj.setCenter(latlng.lat(), latlng.lng());
                    destiLat = latlng.lat();
                    destiLng =latlng.lng();
                    //console.log(destiLat);
                    /*mapObj.addMarker({
                      lat: latlng.lat(),
                      lng: latlng.lng()
                    });*/
                }
              }
            });
          });



        $("#draw").click(function(){
          var northbound, westbound=[];
          var southbound, eastbound=[];
          var boundaries=[];
          var distance;

          westbound = destVincenty(sourcelat,sourceLng,270,1000);
          northbound = destVincenty(westbound[0],westbound[1],0,1000);

          eastbound = destVincenty(destiLat,destiLng,90,1000);
          southbound = destVincenty(eastbound[0],eastbound[1],180,1000);

          var nwlatlng = new google.maps.LatLng(northbound[0],northbound[1]);
          var selatlng = new google.maps.LatLng(southbound[0],southbound[1]);
          boundaries.push(nwlatlng);
          boundaries.push(selatlng);

          mapObj.fitLatLngBounds(boundaries);

          //distance=distVincenty(northbound[0],northbound[1],southbound[0],southbound[1]);

          //south West
          mapObj.addMarker({
                      lat: northbound[0],
                      lng: northbound[1]
                    });

          //North East
          mapObj.addMarker({
                      lat: southbound[0],
                      lng: southbound[1]
                    });

          //South west
           mapObj.addMarker({
                      lat: southbound[0],
                      lng: northbound[1]
                    });
          //North east
          mapObj.addMarker({
            lat:northbound[0],
            lng:southbound[1]
          });

        });



       /*$("#draw").click(function() {

         //Height for boundary
         var northLngLat1,southLngLat1,westLngLat =[];
         var northLngLat2,southLngLat2,eastLngLat =[];
         westLngLat = destVincenty(sourcelat, sourceLng,270,500);
         northLngLat1 = destVincenty(westLngLat[0],westLngLat[1],0,2500);
         southLngLat1 = destVincenty(westLngLat[0],westLngLat[1],180,2500);

         eastLngLat= destVincenty(destiLat,destiLng,90,500);
         northLngLat2 =destVincenty(eastLngLat[0],eastLngLat[1],0,2500);
         southLngLat2 =destVincenty(eastLngLat[0],eastLngLat[1],180,2500);

         //console.log(southLngLat[0]+" "+southLngLat[1]);
         path = [[southLngLat1[0],southLngLat1[1]], [northLngLat1[0],northLngLat1[1]],
                 [northLngLat2[0],northLngLat2[1]],[southLngLat2[0],southLngLat2[1]],
                 [southLngLat1[0],southLngLat1[1]]];

          mapObj.drawPolyline({
            path: path,
            strokeColor: '#131540',
            strokeOpacity: 0.6,
            strokeWeight: 6
          });

       });*/

      });

    </script>

    <form id="draw-route" name="draw-route" action="#" method="get">
      <label for="to">To:</label>
      <input type="text" id="to" name="to" required="required" placeholder="Another address" size="30" />
      <a id="pos-link" href="#">Get my position</a>
      <br />
      <button id="submit" type="button">Submit</button>
      <button id="draw" type="button">Draw</button>
    </form>


  </body>
</html>
